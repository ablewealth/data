<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Client Data Organizer - Tier 1 HNW</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-weight: 300;
            line-height: 1.4;
            background: #ffffff;
            color: #000000;
            font-size: 14px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: #ffffff;
        }
        
        .header {
            padding: 60px 40px;
            border-bottom: 2px solid #000000;
            text-align: left;
        }
        
        .header h1 {
            font-size: 48px;
            font-weight: 100;
            letter-spacing: -1px;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 16px;
            font-weight: 300;
            color: #666666;
        }
        
        .spreadsheet-container {
            padding: 0;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            min-width: 1400px;
        }
        
        .section-header {
            background: #000000;
            color: #ffffff;
            font-weight: 400;
            text-align: left;
            padding: 20px 24px;
            font-size: 16px;
            border: none;
        }
        
        .category-header {
            background: #f8f8f8;
            color: #000000;
            font-weight: 500;
            padding: 16px 24px;
            font-size: 13px;
            border: 1px solid #e0e0e0;
            border-bottom: 2px solid #000000;
        }
        
        .field-label {
            background: #ffffff;
            font-weight: 400;
            padding: 12px 24px;
            border: 1px solid #e0e0e0;
            color: #000000;
            width: 280px;
            vertical-align: middle;
            font-size: 12px;
        }
        
        .data-cell {
            padding: 8px 16px;
            border: 1px solid #e0e0e0;
            background: #ffffff;
            min-width: 180px;
            vertical-align: middle;
        }
        
        .data-cell input, .data-cell select, .data-cell textarea {
            width: 100%;
            border: none;
            padding: 8px;
            font-size: 12px;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-weight: 300;
            background: transparent;
            color: #000000;
        }
        
        .data-cell input:focus, .data-cell select:focus, .data-cell textarea:focus {
            outline: 2px solid #000000;
            outline-offset: -2px;
        }
        
        .data-cell textarea {
            height: 70px;
            resize: vertical;
            line-height: 1.4;
        }
        
        .currency-input {
            text-align: right;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-weight: 400;
        }
        
        .date-input {
            width: 140px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }
        
        .priority-high {
            border-left: 4px solid #000000;
        }
        
        .priority-medium {
            border-left: 4px solid #666666;
        }
        
        .priority-low {
            border-left: 4px solid #cccccc;
        }
        
        .required-missing {
            border-left: 4px solid #e74c3c !important;
            background: #fff5f5 !important;
        }
        
        .calculated-field {
            background: #f8f9fa;
            color: #666666;
            font-weight: 500;
        }
        
        .notes-section {
            background: #f8f8f8;
            padding: 40px;
            margin: 0;
            border-top: 2px solid #000000;
        }
        
        .notes-section h3 {
            font-size: 18px;
            font-weight: 400;
            margin-bottom: 20px;
            color: #000000;
        }
        
        .summary-section {
            background: #ffffff;
            padding: 40px;
            margin: 0;
            border-top: 2px solid #000000;
            display: none;
        }
        
        .summary-section h3 {
            font-size: 18px;
            font-weight: 400;
            margin-bottom: 20px;
            color: #000000;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .summary-card {
            padding: 20px;
            border: 1px solid #e0e0e0;
            background: #f8f8f8;
        }
        
        .summary-card h4 {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 10px;
            color: #000000;
        }
        
        .summary-value {
            font-size: 24px;
            font-weight: 300;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 11px;
            color: #666666;
        }
        
        .action-buttons {
            padding: 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            background: #ffffff;
            border-top: 1px solid #e0e0e0;
        }
        
        .btn {
            background: #000000;
            color: #ffffff;
            border: none;
            padding: 16px 32px;
            font-size: 12px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        
        .btn:hover {
            background: #333333;
        }
        
        .btn-secondary {
            background: #ffffff;
            color: #000000;
            border: 2px solid #000000;
        }
        
        .btn-secondary:hover {
            background: #000000;
            color: #ffffff;
        }
        
        .btn:disabled {
            background: #cccccc;
            color: #666666;
            cursor: not-allowed;
        }
        
        select {
            cursor: pointer;
        }
        
        select option {
            background: #ffffff;
            color: #000000;
        }
        
        .completed {
            background: #f8f9fa !important;
            border-left: 4px solid #27ae60 !important;
        }
        
        .validation-summary {
            background: #fff5f5;
            border: 1px solid #e74c3c;
            border-radius: 4px;
            padding: 20px;
            margin: 20px 40px;
            display: none;
        }
        
        .validation-summary h4 {
            color: #e74c3c;
            margin-bottom: 10px;
        }
        
        .validation-summary ul {
            margin-left: 20px;
            color: #c0392b;
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 40px 20px;
            }
            
            .header h1 {
                font-size: 32px;
            }
            
            .notes-section, .action-buttons {
                padding: 20px;
            }
            
            .field-label {
                width: 220px;
            }
        }
        
        /* Grid overlay for design reference */
        .container {
            background-image: 
                linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
            background-size: 24px 24px;
        }
        
        /* Clean table borders */
        tr:hover {
            background: rgba(0,0,0,0.02);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Master Client Data Organizer</h1>
            <p>Tier 1 High Net Worth Client Reference System</p>
        </div>
        
        <div class="validation-summary" id="validationSummary">
            <h4>Required Fields Missing:</h4>
            <ul id="validationList"></ul>
        </div>
        
        <div class="spreadsheet-container">
            <table>
                <!-- CLIENT NAME -->
                <tr>
                    <td colspan="8" class="section-header">Client Information</td>
                </tr>
                
                <tr>
                    <td class="field-label priority-high">Client Full Legal Name</td>
                    <td class="data-cell" colspan="7"><input type="text" id="clientName" placeholder="Enter full legal name" data-required="true"></td>
                </tr>

                <!-- ASSETS SUMMARY -->
                <tr>
                    <td colspan="8" class="section-header">Assets Summary</td>
                </tr>
                
                <tr>
                    <td colspan="2" class="category-header">Liquid Assets</td>
                    <td colspan="2" class="category-header">Investment Accounts</td>
                    <td colspan="2" class="category-header">Real Estate</td>
                    <td colspan="2" class="category-header">Business Interests</td>
                </tr>
                
                <tr>
                    <td class="field-label priority-high">Cash & Cash Equivalents</td>
                    <td class="data-cell"><input type="text" id="cashEquivalents" class="currency-input" placeholder="0" data-required="true"></td>
                    <td class="field-label priority-high">Taxable Investment Accounts</td>
                    <td class="data-cell"><input type="text" id="taxableInvestments" class="currency-input" placeholder="0" data-required="true"></td>
                    <td class="field-label priority-high">Primary Residence Value</td>
                    <td class="data-cell"><input type="text" id="primaryResidence" class="currency-input" placeholder="0" data-required="true"></td>
                    <td class="field-label">Business Ownership Value</td>
                    <td class="data-cell"><input type="text" id="businessOwnership" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Bank Accounts Total</td>
                    <td class="data-cell"><input type="text" id="bankAccounts" class="currency-input" placeholder="0"></td>
                    <td class="field-label priority-high">Retirement Accounts</td>
                    <td class="data-cell"><input type="text" id="retirementAccounts" class="currency-input" placeholder="0" data-required="true"></td>
                    <td class="field-label">Investment Properties</td>
                    <td class="data-cell"><input type="text" id="investmentProperties" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Partnership Interests</td>
                    <td class="data-cell"><input type="text" id="partnershipInterests" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Money Market & CDs</td>
                    <td class="data-cell"><input type="text" id="moneyMarket" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Trust Accounts</td>
                    <td class="data-cell"><input type="text" id="trustAccounts" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Land Holdings</td>
                    <td class="data-cell"><input type="text" id="landHoldings" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Stock Options & Equity Compensation</td>
                    <td class="data-cell"><input type="text" id="stockOptions" class="currency-input" placeholder="0"></td>
                </tr>

                <!-- ALTERNATIVE INVESTMENTS -->
                <tr>
                    <td colspan="2" class="category-header">Alternative Investments</td>
                    <td colspan="2" class="category-header">Collectibles & Other</td>
                    <td colspan="4" class="category-header">Total Asset Summary</td>
                </tr>
                
                <tr>
                    <td class="field-label">Private Equity</td>
                    <td class="data-cell"><input type="text" id="privateEquity" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Art & Collectibles</td>
                    <td class="data-cell"><input type="text" id="artCollectibles" class="currency-input" placeholder="0"></td>
                    <td class="field-label priority-high">Total Liquid Assets</td>
                    <td class="data-cell"><input type="text" id="totalLiquidAssets" class="currency-input calculated-field" placeholder="0" readonly></td>
                    <td class="field-label priority-high">Total Net Worth</td>
                    <td class="data-cell"><input type="text" id="totalNetWorth" class="currency-input calculated-field" placeholder="0" readonly></td>
                </tr>
                
                <tr>
                    <td class="field-label">Hedge Funds</td>
                    <td class="data-cell"><input type="text" id="hedgeFunds" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Precious Metals</td>
                    <td class="data-cell"><input type="text" id="preciousMetals" class="currency-input" placeholder="0"></td>
                    <td class="field-label priority-high">Total Investment Assets</td>
                    <td class="data-cell"><input type="text" id="totalInvestmentAssets" class="currency-input calculated-field" placeholder="0" readonly></td>
                    <td class="field-label">Asset Allocation Review Date</td>
                    <td class="data-cell"><input type="date" id="assetReviewDate" class="date-input"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Real Estate Funds</td>
                    <td class="data-cell"><input type="text" id="realEstateFunds" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Cryptocurrency</td>
                    <td class="data-cell"><input type="text" id="cryptocurrency" class="currency-input" placeholder="0"></td>
                    <td class="field-label priority-high">Total Real Estate</td>
                    <td class="data-cell"><input type="text" id="totalRealEstate" class="currency-input calculated-field" placeholder="0" readonly></td>
                    <td class="field-label">Last Valuation Update</td>
                    <td class="data-cell"><input type="date" id="lastValuationDate" class="date-input"></td>
                </tr>

                <!-- LIABILITIES & DEBT -->
                <tr>
                    <td colspan="8" class="section-header">Liabilities & Debt</td>
                </tr>
                
                <tr>
                    <td colspan="2" class="category-header">Real Estate Debt</td>
                    <td colspan="2" class="category-header">Personal Debt</td>
                    <td colspan="2" class="category-header">Business Debt</td>
                    <td colspan="2" class="category-header">Debt Summary</td>
                </tr>
                
                <tr>
                    <td class="field-label priority-medium">Primary Residence Mortgage</td>
                    <td class="data-cell"><input type="text" id="primaryMortgage" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Credit Cards</td>
                    <td class="data-cell"><input type="text" id="creditCards" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Business Loans</td>
                    <td class="data-cell"><input type="text" id="businessLoans" class="currency-input" placeholder="0"></td>
                    <td class="field-label priority-medium">Total Debt</td>
                    <td class="data-cell"><input type="text" id="totalDebt" class="currency-input calculated-field" placeholder="0" readonly></td>
                </tr>
                
                <tr>
                    <td class="field-label">Investment Property Loans</td>
                    <td class="data-cell"><input type="text" id="investmentPropertyLoans" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Personal Loans</td>
                    <td class="data-cell"><input type="text" id="personalLoans" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Lines of Credit</td>
                    <td class="data-cell"><input type="text" id="linesOfCredit" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Debt-to-Asset Ratio</td>
                    <td class="data-cell"><input type="text" id="debtToAssetRatio" class="calculated-field" placeholder="0%" readonly></td>
                </tr>
                
                <tr>
                    <td class="field-label">Home Equity Line of Credit</td>
                    <td class="data-cell"><input type="text" id="heloc" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Margin Loans</td>
                    <td class="data-cell"><input type="text" id="marginLoans" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Personal Guarantees</td>
                    <td class="data-cell"><input type="text" id="personalGuarantees" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Monthly Debt Service</td>
                    <td class="data-cell"><input type="text" id="monthlyDebtService" class="currency-input" placeholder="0"></td>
                </tr>

                <!-- INCOME & CASH FLOW -->
                <tr>
                    <td colspan="8" class="section-header">Income & Cash Flow</td>
                </tr>
                
                <tr>
                    <td colspan="2" class="category-header">Employment Income</td>
                    <td colspan="2" class="category-header">Investment Income</td>
                    <td colspan="2" class="category-header">Other Income</td>
                    <td colspan="2" class="category-header">Expenses</td>
                </tr>
                
                <tr>
                    <td class="field-label priority-high">Base Salary</td>
                    <td class="data-cell"><input type="text" id="baseSalary" class="currency-input" placeholder="0" data-required="true"></td>
                    <td class="field-label">Dividends & Interest</td>
                    <td class="data-cell"><input type="text" id="dividendsInterest" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Rental Income</td>
                    <td class="data-cell"><input type="text" id="rentalIncome" class="currency-input" placeholder="0"></td>
                    <td class="field-label priority-high">Annual Living Expenses</td>
                    <td class="data-cell"><input type="text" id="livingExpenses" class="currency-input" placeholder="0" data-required="true"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Bonus & Commission</td>
                    <td class="data-cell"><input type="text" id="bonusCommission" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Capital Gains</td>
                    <td class="data-cell"><input type="text" id="capitalGains" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Business Income</td>
                    <td class="data-cell"><input type="text" id="businessIncome" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Tax Obligations</td>
                    <td class="data-cell"><input type="text" id="taxObligations" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Deferred Compensation</td>
                    <td class="data-cell"><input type="text" id="deferredCompensation" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Partnership Distributions</td>
                    <td class="data-cell"><input type="text" id="partnershipDistributions" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Trust Distributions</td>
                    <td class="data-cell"><input type="text" id="trustDistributions" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Charitable Giving</td>
                    <td class="data-cell"><input type="text" id="charitableGiving" class="currency-input" placeholder="0"></td>
                </tr>

                <!-- INSURANCE COVERAGE -->
                <tr>
                    <td colspan="8" class="section-header">Insurance Coverage</td>
                </tr>
                
                <tr>
                    <td colspan="2" class="category-header">Life Insurance</td>
                    <td colspan="2" class="category-header">Property & Casualty</td>
                    <td colspan="2" class="category-header">Health & Disability</td>
                    <td colspan="2" class="category-header">Specialty Coverage</td>
                </tr>
                
                <tr>
                    <td class="field-label priority-medium">Life Insurance Death Benefit</td>
                    <td class="data-cell"><input type="text" id="lifeInsuranceBenefit" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Homeowners Insurance</td>
                    <td class="data-cell"><input type="text" id="homeownersInsurance" class="currency-input" placeholder="Coverage amount"></td>
                    <td class="field-label">Health Insurance Carrier</td>
                    <td class="data-cell"><input type="text" id="healthInsuranceCarrier" placeholder="Insurance company"></td>
                    <td class="field-label">Umbrella Policy Limit</td>
                    <td class="data-cell"><input type="text" id="umbrellaPolicy" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Life Insurance Cash Value</td>
                    <td class="data-cell"><input type="text" id="lifeInsuranceCashValue" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Auto Insurance</td>
                    <td class="data-cell"><input type="text" id="autoInsurance" placeholder="Coverage details"></td>
                    <td class="field-label">Disability Insurance</td>
                    <td class="data-cell"><input type="text" id="disabilityInsurance" placeholder="Coverage amount"></td>
                    <td class="field-label">Directors & Officers Insurance</td>
                    <td class="data-cell"><input type="text" id="doInsurance" placeholder="Coverage details"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Annual Life Insurance Premiums</td>
                    <td class="data-cell"><input type="text" id="lifeInsurancePremiums" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Valuable Items Coverage</td>
                    <td class="data-cell"><input type="text" id="valuableItemsCoverage" placeholder="Jewelry, art, etc."></td>
                    <td class="field-label">Long-term Care Insurance</td>
                    <td class="data-cell"><input type="text" id="ltcInsurance" placeholder="Coverage details"></td>
                    <td class="field-label">Cyber Liability</td>
                    <td class="data-cell"><input type="text" id="cyberLiability" placeholder="Coverage details"></td>
                </tr>

                <!-- ESTATE PLANNING -->
                <tr>
                    <td colspan="8" class="section-header">Estate Planning</td>
                </tr>
                
                <tr>
                    <td colspan="2" class="category-header">Estate Documents</td>
                    <td colspan="2" class="category-header">Trust Structures</td>
                    <td colspan="2" class="category-header">Beneficiaries</td>
                    <td colspan="2" class="category-header">Estate Strategy</td>
                </tr>
                
                <tr>
                    <td class="field-label priority-medium">Will Date</td>
                    <td class="data-cell"><input type="date" id="willDate" class="date-input"></td>
                    <td class="field-label">Revocable Trust</td>
                    <td class="data-cell">
                        <select id="revocableTrust">
                            <option>Select</option>
                            <option>Yes</option>
                            <option>No</option>
                            <option>In Progress</option>
                        </select>
                    </td>
                    <td class="field-label">Primary Beneficiaries</td>
                    <td class="data-cell"><textarea id="primaryBeneficiaries" placeholder="Names and percentages"></textarea></td>
                    <td class="field-label">Estate Tax Exposure</td>
                    <td class="data-cell"><input type="text" id="estateTaxExposure" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Power of Attorney</td>
                    <td class="data-cell">
                        <select id="powerOfAttorney">
                            <option>Select</option>
                            <option>Current</option>
                            <option>Needs Update</option>
                            <option>None</option>
                        </select>
                    </td>
                    <td class="field-label">Irrevocable Trusts</td>
                    <td class="data-cell"><input type="text" id="irrevocableTrusts" placeholder="Types and values"></td>
                    <td class="field-label">Contingent Beneficiaries</td>
                    <td class="data-cell"><textarea id="contingentBeneficiaries" placeholder="Names and percentages"></textarea></td>
                    <td class="field-label">Annual Gifting Strategy</td>
                    <td class="data-cell"><input type="text" id="annualGifting" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Healthcare Directive</td>
                    <td class="data-cell">
                        <select id="healthcareDirective">
                            <option>Select</option>
                            <option>Current</option>
                            <option>Needs Update</option>
                            <option>None</option>
                        </select>
                    </td>
                    <td class="field-label">Trust Assets Value</td>
                    <td class="data-cell"><input type="text" id="trustAssetsValue" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Guardian Designations</td>
                    <td class="data-cell"><input type="text" id="guardianDesignations" placeholder="For minor children"></td>
                    <td class="field-label">Charitable Planning</td>
                    <td class="data-cell"><input type="text" id="charitablePlanning" placeholder="DAF, CRT, etc."></td>
                </tr>

                <!-- TAX INFORMATION -->
                <tr>
                    <td colspan="8" class="section-header">Tax Information</td>
                </tr>
                
                <tr>
                    <td colspan="2" class="category-header">Tax Status</td>
                    <td colspan="2" class="category-header">Current Year Estimates</td>
                    <td colspan="4" class="category-header">Tax Planning</td>
                </tr>
                
                <tr>
                    <td class="field-label">Filing Status</td>
                    <td class="data-cell">
                        <select id="filingStatus">
                            <option>Select</option>
                            <option>Married Filing Jointly</option>
                            <option>Married Filing Separately</option>
                            <option>Single</option>
                            <option>Head of Household</option>
                        </select>
                    </td>
                    <td class="field-label priority-medium">Estimated Federal Tax</td>
                    <td class="data-cell"><input type="text" id="estimatedFederalTax" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Tax Loss Harvesting</td>
                    <td class="data-cell"><input type="text" id="taxLossHarvesting" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Retirement Contributions</td>
                    <td class="data-cell"><input type="text" id="retirementContributions" class="currency-input" placeholder="0"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Effective Tax Rate</td>
                    <td class="data-cell"><input type="text" id="effectiveTaxRate" placeholder="0%"></td>
                    <td class="field-label">Estimated State Tax</td>
                    <td class="data-cell"><input type="text" id="estimatedStateTax" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Charitable Deductions</td>
                    <td class="data-cell"><input type="text" id="charitableDeductions" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Tax Planning Notes</td>
                    <td class="data-cell"><input type="text" id="taxPlanningNotes" placeholder="Strategies and considerations"></td>
                </tr>
                
                <tr>
                    <td class="field-label">Alternative Minimum Tax Exposure</td>
                    <td class="data-cell">
                        <select id="amtExposure">
                            <option>Select</option>
                            <option>Yes</option>
                            <option>No</option>
                            <option>Uncertain</option>
                        </select>
                    </td>
                    <td class="field-label">Quarterly Estimated Payments</td>
                    <td class="data-cell"><input type="text" id="quarterlyPayments" class="currency-input" placeholder="0"></td>
                    <td class="field-label">Last Tax Return Review</td>
                    <td class="data-cell"><input type="date" id="lastTaxReview" class="date-input"></td>
                    <td class="field-label">Next Tax Planning Meeting</td>
                    <td class="data-cell"><input type="date" id="nextTaxMeeting" class="date-input"></td>
                </tr>
            </table>
        </div>

        <div class="summary-section" id="summarySection">
            <h3>Executive Summary</h3>
            <div class="summary-grid">
                <div class="summary-card">
                    <h4>Net Worth</h4>
                    <div class="summary-value" id="summaryNetWorth">$0</div>
                    <div class="summary-label">Total assets minus total liabilities</div>
                </div>
                <div class="summary-card">
                    <h4>Liquid Assets</h4>
                    <div class="summary-value" id="summaryLiquidAssets">$0</div>
                    <div class="summary-label">Immediately accessible funds</div>
                </div>
                <div class="summary-card">
                    <h4>Investment Assets</h4>
                    <div class="summary-value" id="summaryInvestmentAssets">$0</div>
                    <div class="summary-label">Portfolios and retirement accounts</div>
                </div>
                <div class="summary-card">
                    <h4>Debt-to-Asset Ratio</h4>
                    <div class="summary-value" id="summaryDebtRatio">0%</div>
                    <div class="summary-label">Overall leverage position</div>
                </div>
            </div>
            <div id="summaryText"></div>
        </div>

        <div class="notes-section">
            <h3>Client Notes & Special Considerations</h3>
            <textarea id="clientNotes" style="width: 100%; height: 120px; border: 2px solid #e0e0e0; padding: 16px; font-family: 'Helvetica Neue', Arial, sans-serif; font-size: 12px; line-height: 1.4; background: #ffffff;" placeholder="Enter any special notes, considerations, or important details about this client..."></textarea>
        </div>

        <div class="action-buttons">
            <button class="btn" onclick="validateForm()">Validate Data</button>
            <button class="btn" onclick="calculateTotals()">Calculate Totals</button>
            <button class="btn" onclick="generateSummary()">Generate Summary</button>
            <button class="btn btn-secondary" onclick="exportData()">Export Data</button>
            <button class="btn btn-secondary" onclick="printSummary()">Print Summary</button>
        </div>
    </div>

    <script>
        // Initialize data object to store all values
        let clientData = {};
        
        // Currency formatting function
        function formatCurrency(value) {
            const num = parseFloat(value.toString().replace(/[^0-9.-]/g, ''));
            return isNaN(num) ? 0 : num;
        }
        
        function displayCurrency(value) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(value);
        }
        
        // Real-time calculations
        function calculateTotals() {
            // Calculate liquid assets
            const liquidAssets = [
                'cashEquivalents', 'bankAccounts', 'moneyMarket'
            ].reduce((sum, id) => sum + formatCurrency(document.getElementById(id).value), 0);
            
            // Calculate investment assets
            const investmentAssets = [
                'taxableInvestments', 'retirementAccounts', 'trustAccounts',
                'privateEquity', 'hedgeFunds', 'realEstateFunds'
            ].reduce((sum, id) => sum + formatCurrency(document.getElementById(id).value), 0);
            
            // Calculate real estate total
            const realEstateTotal = [
                'primaryResidence', 'investmentProperties', 'landHoldings'
            ].reduce((sum, id) => sum + formatCurrency(document.getElementById(id).value), 0);
            
            // Calculate business interests
            const businessTotal = [
                'businessOwnership', 'partnershipInterests', 'stockOptions'
            ].reduce((sum, id) => sum + formatCurrency(document.getElementById(id).value), 0);
            
            // Calculate other assets
            const otherAssets = [
                'artCollectibles', 'preciousMetals', 'cryptocurrency'
            ].reduce((sum, id) => sum + formatCurrency(document.getElementById(id).value), 0);
            
            // Calculate total assets
            const totalAssets = liquidAssets + investmentAssets + realEstateTotal + businessTotal + otherAssets;
            
            // Calculate total debt
            const totalDebt = [
                'primaryMortgage', 'investmentPropertyLoans', 'heloc',
                'creditCards', 'personalLoans', 'marginLoans',
                'businessLoans', 'linesOfCredit', 'personalGuarantees'
            ].reduce((sum, id) => sum + formatCurrency(document.getElementById(id).value), 0);
            
            // Calculate net worth
            const netWorth = totalAssets - totalDebt;
            
            // Calculate debt-to-asset ratio
            const debtRatio = totalAssets > 0 ? (totalDebt / totalAssets * 100).toFixed(1) : 0;
            
            // Update calculated fields
            document.getElementById('totalLiquidAssets').value = displayCurrency(liquidAssets);
            document.getElementById('totalInvestmentAssets').value = displayCurrency(investmentAssets);
            document.getElementById('totalRealEstate').value = displayCurrency(realEstateTotal);
            document.getElementById('totalDebt').value = displayCurrency(totalDebt);
            document.getElementById('totalNetWorth').value = displayCurrency(netWorth);
            document.getElementById('debtToAssetRatio').value = debtRatio + '%';
            
            // Store in data object
            clientData.calculations = {
                liquidAssets,
                investmentAssets,
                realEstateTotal,
                totalAssets,
                totalDebt,
                netWorth,
                debtRatio
            };
            
            // Auto-update summary if visible
            if (document.getElementById('summarySection').style.display !== 'none') {
                updateSummaryDisplay();
            }
        }
        
        function validateForm() {
            const requiredFields = document.querySelectorAll('[data-required="true"]');
            const missingFields = [];
            const validationSummary = document.getElementById('validationSummary');
            const validationList = document.getElementById('validationList');
            
            // Clear previous validation
            document.querySelectorAll('.required-missing').forEach(field => {
                field.classList.remove('required-missing');
            });
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    const label = field.closest('tr').querySelector('.field-label').textContent;
                    missingFields.push(label);
                    field.closest('.data-cell').classList.add('required-missing');
                }
            });
            
            if (missingFields.length > 0) {
                validationList.innerHTML = missingFields.map(field => `<li>${field}</li>`).join('');
                validationSummary.style.display = 'block';
                validationSummary.scrollIntoView({ behavior: 'smooth' });
                return false;
            } else {
                validationSummary.style.display = 'none';
                alert('✓ All required fields completed successfully!');
                return true;
            }
        }
        
        function updateSummaryDisplay() {
            const calcs = clientData.calculations || {};
            document.getElementById('summaryNetWorth').textContent = displayCurrency(calcs.netWorth || 0);
            document.getElementById('summaryLiquidAssets').textContent = displayCurrency(calcs.liquidAssets || 0);
            document.getElementById('summaryInvestmentAssets').textContent = displayCurrency(calcs.investmentAssets || 0);
            document.getElementById('summaryDebtRatio').textContent = (calcs.debtRatio || 0) + '%';
        }
        
        function generateSummary() {
            calculateTotals();
            const summarySection = document.getElementById('summarySection');
            const summaryText = document.getElementById('summaryText');
            const clientName = document.getElementById('clientName').value || 'Client';
            const calcs = clientData.calculations;
            
            if (!calcs) {
                alert('Please enter financial data before generating summary.');
                return;
            }
            
            // Generate executive summary text
            let summary = `<h4>Executive Summary for ${clientName}</h4>`;
            summary += `<p><strong>Net Worth Analysis:</strong> ${clientName} has a total net worth of ${displayCurrency(calcs.netWorth)}, `;
            
            if (calcs.netWorth > 10000000) {
                summary += `placing them in the ultra-high net worth category.`;
            } else if (calcs.netWorth > 1000000) {
                summary += `placing them in the high net worth category.`;
            } else {
                summary += `indicating developing wealth accumulation.`;
            }
            
            summary += `</p><p><strong>Asset Allocation:</strong> `;
            const totalAssets = calcs.totalAssets;
            if (totalAssets > 0) {
                const liquidPct = (calcs.liquidAssets / totalAssets * 100).toFixed(1);
                const investmentPct = (calcs.investmentAssets / totalAssets * 100).toFixed(1);
                const realEstatePct = (calcs.realEstateTotal / totalAssets * 100).toFixed(1);
                
                summary += `Liquid assets comprise ${liquidPct}% of total assets, `;
                summary += `investment portfolios ${investmentPct}%, `;
                summary += `and real estate holdings ${realEstatePct}%.`;
            }
            
            summary += `</p><p><strong>Leverage Assessment:</strong> `;
            if (calcs.debtRatio < 20) {
                summary += `Conservative debt position at ${calcs.debtRatio}% debt-to-asset ratio.`;
            } else if (calcs.debtRatio < 40) {
                summary += `Moderate leverage position at ${calcs.debtRatio}% debt-to-asset ratio.`;
            } else {
                summary += `Higher leverage position at ${calcs.debtRatio}% debt-to-asset ratio requires monitoring.`;
            }
            summary += `</p>`;
            
            summaryText.innerHTML = summary;
            updateSummaryDisplay();
            summarySection.style.display = 'block';
            summarySection.scrollIntoView({ behavior: 'smooth' });
        }
        
        function exportData() {
            const allInputs = document.querySelectorAll('input, select, textarea');
            const exportData = {};
            
            allInputs.forEach(input => {
                if (input.id) {
                    exportData[input.id] = input.value;
                }
            });
            
            // Add calculations
            exportData.calculations = clientData.calculations;
            
            // Create downloadable JSON
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `${exportData.clientName || 'client'}_data_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('✓ Client data exported successfully!');
        }
        
        function printSummary() {
            if (document.getElementById('summarySection').style.display === 'none') {
                alert('Please generate summary first.');
                return;
            }
            
            const printWindow = window.open('', '_blank');
            const clientName = document.getElementById('clientName').value || 'Client';
            const summaryContent = document.getElementById('summarySection').innerHTML;
            
            printWindow.document.write(`
                <html>
                <head>
                    <title>${clientName} - Financial Summary</title>
                    <style>
                        body { font-family: 'Helvetica Neue', Arial, sans-serif; padding: 20px; }
                        .summary-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 20px 0; }
                        .summary-card { padding: 15px; border: 1px solid #ddd; }
                        .summary-value { font-size: 20px; font-weight: bold; }
                        .summary-label { font-size: 12px; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>${clientName} - Financial Summary</h1>
                    <p>Generated on: ${new Date().toLocaleDateString()}</p>
                    ${summaryContent}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        // Auto-format currency inputs and trigger calculations
        document.addEventListener('input', function(e) {
            if (e.target.classList.contains('currency-input') && !e.target.readOnly) {
                // Auto-calculate on value change
                setTimeout(() => calculateTotals(), 100);
            }
        });
        
        // Visual feedback for completed fields
        document.addEventListener('change', function(e) {
            if (e.target.value && e.target.value.trim() !== '') {
                e.target.closest('.data-cell').classList.add('completed');
                e.target.closest('.data-cell').classList.remove('required-missing');
            } else {
                e.target.closest('.data-cell').classList.remove('completed');
            }
        });
        
        // Focus states
        document.addEventListener('focusin', function(e) {
            if (e.target.matches('input, select, textarea')) {
                e.target.closest('.data-cell').style.background = '#f8f8f8';
            }
        });
        
        document.addEventListener('focusout', function(e) {
            if (e.target.matches('input, select, textarea')) {
                e.target.closest('.data-cell').style.background = '#ffffff';
            }
        });
        
        // Initialize calculations on page load
        document.addEventListener('DOMContentLoaded', function() {
            calculateTotals();
        });
    </script>
</body>
</html>
